<!DOCTYPE html>
<html>
<head>
    <title>视频时长显示</title>
</head>
<body>
<!-- 通过URL参数传递视频地址 -->
<script>
    const urlParams = new URLSearchParams(window.location.search);
    const videoUrl = urlParams.get('videoUrl'); // 获取如 ?videoUrl=https://cdn2.gzsg.org/upload/tinymce/1744618564375.mp4
</script>

<video id="myVideo" controls crossorigin="anonymous"></video>
<p id="durationDisplay">视频加载中...</p>

<script>
    // 格式化时长为 HH:MM:SS
    function formatDuration(seconds) {
        const hours = Math.floor(seconds / 3600);
        const minutes = Math.floor((seconds % 3600) / 60);
        const secs = Math.floor(seconds % 60);
        
        return [
            hours.toString().padStart(2, '0'),
            minutes.toString().padStart(2, '0'),
            secs.toString().padStart(2, '0')
        ].join(':');
    }

    const video = document.getElementById('myVideo');
    if (videoUrl) {
        video.src = videoUrl; // 设置视频源
        
        video.addEventListener('loadedmetadata', function() {
            const duration = video.duration;
            if (isNaN(duration)) {
                document.getElementById('durationDisplay').textContent = '无法获取视频时长';
                return;
            }
            
            const tim = formatDuration(duration);
            document.getElementById('durationDisplay').textContent = 
                `视频时长：${tim}, 总秒数：${duration.toFixed(2)}秒`;

            // 将时长存入URL或本地存储
            // const newUrl = `${window.location.href}&duration=${duration}`;
            // window.history.replaceState(null, '', newUrl); // 更新URL参数
            // localStorage.setItem('videoDuration', duration); // 存入本地存储
        });
        
        video.addEventListener('error', function() {
            document.getElementById('durationDisplay').textContent = '视频加载失败';
        });
    } else {
        document.getElementById('durationDisplay').textContent = '未提供视频URL';
    }
</script>
</body>
</html>
